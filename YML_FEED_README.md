# YML Фид врачей для Яндекса

## Описание

Функционал для генерации YML фида врачей согласно инструкции Яндекса для отображения карточек врачей в поисковой выдаче.

## Компоненты

### 1. Сервис генерации фида
- **Файл**: `app/Services/YmlFeedService.php`
- **Функции**:
  - Генерация XML структуры согласно стандарту YML
  - Обработка данных врачей, клиник, услуг и предложений
  - Сохранение фида в папку `storage/app/public/`

### 2. Контроллер
- **Файл**: `app/Http/Controllers/YmlFeedController.php`
- **Методы**:
  - `generateDoctorsFeed()` - генерация фида через AJAX
  - `downloadFeed()` - скачивание сгенерированного файла

### 3. Команда Artisan
- **Файл**: `app/Console/Commands/GenerateYmlFeedCommand.php`
- **Использование**: `php artisan yml-feed:generate --save`

### 4. Кнопка в админке Filament
- **Файл**: `app/Filament/Resources/DoctorResource/Pages/ListDoctors.php`
- **Расположение**: Страница списка врачей в админке

## Использование

### Через админку Filament
1. Перейдите в раздел "Специалисты" в админке
2. Нажмите кнопку "Генерировать YML фид врачей"
3. Подтвердите генерацию
4. Скачайте сгенерированный файл

### Через команду Artisan
```bash
# Генерация и сохранение в файл
php artisan yml-feed:generate --save

# Только генерация (вывод в консоль)
php artisan yml-feed:generate
```

### Через API
```bash
# POST запрос для генерации
curl -X POST http://your-domain.com/admin/yml-feed/generate

# GET запрос для скачивания
curl -O http://your-domain.com/admin/yml-feed/download/filename.xml
```

## Структура фида

Фид содержит следующие секции:

### 1. Врачи (`doctors`)
- Основная информация (ФИО, специальность, стаж)
- Образование и сертификаты
- Отзывы пациентов
- Ссылки на профили

### 2. Клиники (`clinics`)
- Название и контакты клиники
- Адрес и рабочие часы

### 3. Услуги (`services`)
- Основные медицинские услуги
- Ссылки на страницы услуг

### 4. Предложения (`offers`)
- Связка врач-клиника-услуга
- Цены и доступность

## Настройка

### Конфигурация клиники
В файле `app/Services/YmlFeedService.php` можно настроить:
- Название клиники
- Контактную информацию
- Адрес и рабочие часы

### Цены услуг
В методе `addOffers()` можно настроить цены для разных услуг.

## Требования Яндекса

Фид соответствует требованиям Яндекса:
- Формат YML (XML)
- Кодировка UTF-8
- Валидная XML структура
- Все обязательные поля заполнены

## Ограничения

- Максимум 30,000 врачей в одном файле
- Размер файла не более 5 МБ
- Максимум 1 изображение на врача
- Максимум 50,000 изображений общее

## Поддержка

Для подключения к Яндексу обратитесь в службу поддержки:
- Email: med-search@yandex-team.ru
- Тема: "Интеграция онлайн‑расписания врачей: предложение о сотрудничестве от [Название организации]"
